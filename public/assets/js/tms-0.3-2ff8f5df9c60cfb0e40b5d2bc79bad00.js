/* jQuery based image slider
/* TMSlider 0.3 */
function clone(a){if(!a||typeof a!=typeof {})return a;if(a instanceof Array)return[].concat(a);var b=new a.constructor,c;for(c in a)a.hasOwnProperty(c)&&(b[c]=clone(a[c]));return b}(function(a,b){var c=window._TMS=a.fn._TMS=function(b){return b=b||{},b=a.extend(clone(c),c.presets[b.preset],b),b.init.call(b.me=b.holder=this,b),b.me.data({opt:b})};a.extend(c,{etal:"<div></div>",items:".items>li",pic:"pic",mask:"mask",paginationCl:"pagination",currCl:"current",pauseCl:"paused",bannerCl:"banner",numStatusCl:"numStatus",pagNums:!0,overflow:"hidden",show:0,changeEv:"click",blocksX:1,blocksY:1,preset:"simpleFade",duration:1e3,easing:"linear",way:"lines",anim:"fade",pagination:!0,banners:!1,waitBannerAnimation:!0,slideshow:!1,progressBar:!1,pauseOnHover:!1,nextBu:!1,prevBu:!1,playBu:!1,preFu:function(){var b=this,c=a(new Image);b.pic=a(b.etal).addClass(b.pic).css({overflow:b.overflow}).appendTo(b.me),b.mask=a(b.etal).addClass(b.mask).appendTo(b.pic),b.me.css("position")=="static"&&b.me.css({position:"relative"}),b.me.css("z-index")=="auto"&&b.me.css({zIndex:1}),b.me.css({overflow:b.overflow}),b.items&&b.parseImgFu(),c.appendTo(b.me).load(function(){b.pic.css({width:b.width=c.width(),height:b.height=c.height(),background:"url("+b.itms[b.show]+") 0 0 no-repeat"}),c.remove(),b.current=b.buff=b.show}).attr({src:b.itms[b.n=b.show]})},sliceFu:function(b,c){var d=this,b=d.blocksX,c=d.blocksY,e=parseInt(d.width/b),f=parseInt(d.height/c),g=a(d.etal),h=d.pic.width()-e*b,i=d.pic.height()-f*c,j,k,l=d.matrix=[];d.mask.css({position:"absolute",width:"100%",height:"100%",left:0,top:0,zIndex:1}).empty().appendTo(d.pic);for(k=0;k<c;k++)for(j=0;j<b;j++)l[k]=l[k]?l[k]:[],l[k][j]=a(d.etal).clone().appendTo(d.mask).css({left:j*e,top:k*f,position:"absolute",width:j==b-1?e+h:e,height:k==c-1?f+i:f,backgroundPosition:"-"+j*e+"px -"+k*f+"px",display:"none"});d.maskC=d.mask.children()},changeFu:function(b){var d=this;if(d.bl)return!1;if(b==d.n)return!1;d.n=b,d.next=d.itms[b],d.direction=b-d.buff,d.direction==d.itms.length-1&&(d.direction=-1),d.direction==-1*d.itms.length+1&&(d.direction=2),d.current=d.buff=b,d.numStatus&&d.numStatusChFu(),d.pagination&&d.pags.removeClass(d.currCl).eq(b).addClass(d.currCl),d.banners!==!1&&d.banner&&d.bannerHide(d.banner,d),d.progressBar&&(clearInterval(d.slShTimer),d.progressBar.stop()),d.slideshow&&!d.paused&&d.progressBar&&d.progressBar.stop().width(0);var e=function(){d.preset_!=d.preset&&(d.du=d.duration,d.ea=d.easing,a.extend(d,c.presets[d.preset]),d.duration=d.du,d.easing=d.ea,d.preset_=d.preset),d.sliceFu(),d.maskC.stop().css({backgroundImage:"url("+d.next+")"}),d.beforeAnimation(),d.showFu()};d.waitBannerAnimation?a.when(d.banner).then(e):e()},nextFu:function(){var a=this,b=a.n;a.changeFu(++b<a.itms.length?b:0)},prevFu:function(){var a=this,b=a.n;a.changeFu(--b>=0?b:a.itms.length-1)},showFu:function(){var a=this,b,c;b=a.ways[a.way].call(a),a.reverseWay&&b.reverse(),a.dirMirror&&(b=a.dirMirrorFu(b)),a.int&&clearInterval(a.int),a.int=setInterval(function(){b.length?a.anims[a.anim].apply(a,[b.shift(),!b.length]):clearInterval(a.int)},a.interval),a.bl=!0},dirMirrorFu:function(a){var b=this;return b.direction<0&&void 0,a},afterShow:function(){var a=this;a.pic.css({backgroundImage:"url("+a.next+")"}),a.maskC.hide(),a.slideshow&&!a.paused&&a.startSlShFu(0),a.banners!==!1&&(a.banner=a.banners[a.n]),a.banner&&(a.banner.appendTo(a.me),a.bannerShow(a.banner,a)),a.afterAnimation(),a.bl=!1},bannerShow:function(){},bannerHide:function(){},parseImgFu:function(){var b=this;b.itms=[],a(b.items+" img",b.me).each(function(c){b.itms[c]=a(this).attr("src")})},controlsFu:function(){var b=this;b.nextBu&&a(b.nextBu).bind(b.changeEv,function(){return b.nextFu(),!1}),b.prevBu&&a(b.prevBu).bind(b.changeEv,function(){return b.prevFu(),!1})},paginationFu:function(){var b=this;if(b.pagination===!1)return!1;b.pagination===!0?(b.pags=a("<ul></ul>").addClass(b.paginationCl).appendTo(b.me),a(b.itms).each(function(c){var d=a("<li></li>"),e=a('<a href="#"></a>').text(b.pagNums?c+1:"").appendTo(d).bind(b.changeEv,function(){return b.changeFu(c),!1});b.pags.append(d)}),b.pags=b.pags.find("li"),b.pags.eq(b.n).addClass(b.currCl)):(b.pags=a(b.pagination)).parent().length&&(b.pags.children().each(function(c){var d=a(this),e=a("a",d).bind(b.changeEv,function(){return b.changeFu(c),!1})}),b.pags=b.pags.find("li"),b.pags.eq(b.n).addClass(b.currCl))},startSlShFu:function(b){var c=this;c.paused=!1,c.prog=b||0,clearInterval(c.slShTimer),c.slShTimer=setInterval(function(){c.prog<100?c.prog++:(c.prog=0,clearInterval(c.slShTimer),c.nextFu()),c.progressBar&&c.pbchFu()},c.slideshow/100),c.playBu&&a(c.playBu).removeClass(c.pauseCl)},pauseSlShFu:function(){var b=this;b.paused=!0,clearInterval(b.slShTimer),b.playBu&&a(b.playBu).addClass(b.pauseCl)},slideshowFu:function(){var b=this;if(b.slideshow===!1)return!1;b.playBu&&a(b.playBu).bind(b.changeEv,function(){return b.paused?b.startSlShFu(b.prog):b.pauseSlShFu(),!1}),b.startSlShFu()},pbchFu:function(){var a=this;a.prog==0?a.progressBar.stop().width(0):a.progressBar.stop().animate({width:a.prog+"%"},{easing:"linear",duration:a.slideshow/100})},progressBarFu:function(){var b=this;if(b.progressBar===!1)return!1;b.progressBar=a(b.progressBar),b.progressBar.parent().length==0&&b.progressBar.appendTo(b.me)},pauseOnHoverFu:function(){var a=this;a.pauseOnHover&&a.me.bind("mouseenter",function(){a.pauseSlShFu()}).bind("mouseleave",function(){a.startSlShFu(a.prog)})},bannersFu:function(){var b=this;if(b.banners===!1)return!1;b.banners!==!0&&typeof b.banners=="string"&&(b.bannerShow=b.bannersPresets[b.banners].bannerShow,b.bannerHide=b.bannersPresets[b.banners].bannerHide),b.banners=[],a(b.items,b.me).each(function(c){var d;b.banners[c]=(d=a("."+b.bannerCl,this)).length?d.css({zIndex:999}):!1}),b.bannerShow(b.banner=b.banners[b.show].appendTo(b.me),b)},bannerDuration:1e3,bannerEasing:"swing",bannersPresets:{fromLeft:{bannerShow:function(a,b){a.css("top")=="auto"&&a.css("top",0),a.stop().css({left:-a.width()}).animate({left:0},{duration:b.bannerDuration,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({left:-a.width()},{duration:b.bannerDuration,easing:b.bannerEasing})}},fromRight:{bannerShow:function(a,b){a.css("top")=="auto"&&a.css("top",0),a.css("left")!="auto"&&a.css("left","auto"),a.stop().css({right:-a.width()}).animate({right:0},{duration:b.bannerDuration,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({right:-a.width()},{duration:b.bannerDuration,easing:b.bannerEasing})}},fromBottom:{bannerShow:function(a,b){a.css("left")=="auto"&&a.css("left",0),a.css("top")!="auto"&&a.css("top","auto"),a.stop().css({bottom:-a.height()}).animate({bottom:0},{duration:b.bannerDuration,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({bottom:-a.height()})}},fromBottom1:{bannerShow:function(a,b){a.css("left")=="auto"&&a.css("left",0),a.css("top")!="auto"&&a.css("top","auto"),a.stop().css({bottom:-a.height(),left:-a.width()}).animate({bottom:0,left:0},{duration:300,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({left:-a.width(),bottom:-a.height()},300)}},fromTop:{bannerShow:function(a,b){a.css("left")=="auto"&&a.css("left",0),a.stop().css({top:-a.height()}).animate({top:0},{duration:b.bannerDuration,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({top:-a.height()},{duration:b.bannerDuration,easing:b.bannerEasing})}},fade:{bannerShow:function(a,b){a.css("left")=="auto"&&a.css("left",0),a.css("top")=="auto"&&a.css("top",0),a.stop().css({opacity:0}).animate({opacity:1},{duration:b.bannerDuration,easing:b.bannerEasing})},bannerHide:function(a,b){a.stop().animate({opacity:0},{duration:b.bannerDuration,easing:b.bannerEasing})}}},numStatusChFu:function(){var b=this;b.numSt.html('<span class="curr"></span>/<span class="total"></span>'),a(".curr",b.numSt).text(b.n+1),a(".total",b.numSt).text(b.itms.length)},numStatusFu:function(){var b=this;if(b.numStatus===!1)return!1;b.numSt||(b.numStatus===!0?b.numSt=a(b.etal).addClass(b.numStatusCl):b.numSt=a(b.numStatus).addClass(b.numStatusCl)),b.numSt.parent().length||b.numSt.appendTo(b.me).addClass(b.numStatusCl),b.numStatusChFu()},init:function(a){a.preFu(),a.controlsFu(),a.paginationFu(),a.slideshowFu(),a.progressBarFu(),a.pauseOnHoverFu(),a.bannersFu(),a.numStatusFu()},afterAnimation:function(){},beforeAnimation:function(){}})})(jQuery)