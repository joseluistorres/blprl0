/*
 * requiredfield jquery widget
 *
 * Copyright 2011, Acatl Pacheco
 * Licensed under the MIT License.
 *
 */
$.widget("ui.requiredfield",{options:{isRequired:!0,requiredClass:"required",watermarkText:null,watermarkClass:"watermark",functionValidate:null,dataType:"string",liveCheck:!1,leaveWatermark:!1,defaultIsInvalid:!1},_create:function(){this.element.focus($.proxy(this._focusHandler,this)),this.element.blur($.proxy(this._blurHandler,this)),this.options.liveCheck&&this.element.keyup($.proxy(this._keyupHandler,this))},_init:function(){this.options.watermarkText!=null&&this._updateWatermark()},_focusHandler:function(a){var b=this.element.val();b==this.options.watermarkText&&!this.options.leaveWatermark&&this.element.val(""),this.element.toggleClass(this.options.watermarkClass,!1),!this.options.leaveWatermark},_blurHandler:function(a){this._updateWatermark(),this._updateValidation()},_keyupHandler:function(a){this._updateValidation()},_updateValidation:function(){this.validate()},_updateWatermark:function(){if(this.options.watermarkText==null)return;var a=this.element.val(),b=!1;if(a==""||a==this.options.watermarkText)b=!0,this.element.val(this.options.watermarkText);this.element.toggleClass(this.options.watermarkClass,b)},refresh:function(){arguments[0]==1&&this.element.val(""),this.options.watermarkText!=null&&this._updateWatermark(),this.element.toggleClass(this.options.requiredClass,!1)},validate:function(){var a=!0;return this.options.isRequired&&(a=this.isValid()),this.element.toggleClass(this.options.requiredClass,!a),a},isValid:function(){var a=this.element.val(),b=!0;if(a=="")return!1;if(this.options.defaultIsInvalid==1&&a==this.options.watermarkText)return!1;var c=!0;if(this.options.dataType!=null){var d=null;switch(this.options.dataType){case"number":c=!isNaN(Number(a));break;case"string":default:c=jQuery.type(a)==this.options.dataType}if(!c)return!1}var e=!0;return this.options.functionValidate!=null&&(e=this.options.functionValidate(this.element.val())),c&&e}})